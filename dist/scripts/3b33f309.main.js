StudentTableView=Backbone.View.extend({template:_.template($("#table-view").text()),className:"table-view",initialize:function(){$(".template-container").append(this.$el),this.render()},render:function(){this.$el.append(this.template({student:this.model})),$(".title").text("Student Directory")}}),StudentFullView=Backbone.View.extend({template:_.template($("#full-view").text()),ClassName:"container",initialize:function(){$(".template-container").html(""),$(".template-container").append(this.$el),this.render()},render:function(){this.$el.append(this.template({student:this.model})),$(".title").text(this.model.get("name")),this.seePrevious(),this.seeNext()},seePrevious:function(){var a=this.setVariables();0===a.index?a.index=a.collection.length-1:a.index-=1,$(".see-previous").attr("href","#"+a.collection.at(a.index).get("_id"))},seeNext:function(){var a=this.setVariables();a.index===a.collection.length-1?a.index=0:a.index+=1,$(".see-next").attr("href","#"+a.collection.at(a.index).get("_id"))},setVariables:function(){var a=this.model.get("_id"),b=this.model.collection,c=b.indexOf(b.get(a)),d={id:a,collection:b,index:c};return d}}),AddStudentView=Backbone.View.extend({template:_.template($("#add-or-edit-view").text()),events:{"click .save":"save","click .cancel":"cancel"},initialize:function(){$(".template-container").html(""),$(".template-container").append(this.$el),this.render()},render:function(){var a=_.template($("#add-buttons").text());this.$el.append(this.template({student:this.model,buttonsTemplate:a}))},save:function(){""===$(".student-name").val()?this.model.set("name","?"):this.model.set("name",$(".student-name").val()),this.model.set("cell",$(".student-cell").val()),this.model.set("email",$(".student-email").val()),this.model.set("github",$(".student-github").val()),this.model.set("image",$(".student-image").val()),this.model.save({},{success:function(){router.navigate("",{trigger:!0})}})},cancel:function(){this.model.collection.remove(this.model)}}),EditStudentView=Backbone.View.extend({template:_.template($("#add-or-edit-view").text()),events:{"click .save":"save","click .remove":"doNotSave"},initialize:function(){$(".template-container").html(""),$(".template-container").append(this.$el),this.render()},render:function(){var a=_.template($("#edit-buttons").text());this.$el.append(this.template({student:this.model,buttonsTemplate:a}))},save:function(){this.model.set("name",$(".student-name").val()),this.model.set("cell",$(".student-cell").val()),this.model.set("email",$(".student-email").val()),this.model.set("github",$(".student-github").val()),this.model.set("image",$(".student-image").val()),this.model.save()},doNotSave:function(){this.model.destroy({success:function(){router.navigate("",{trigger:!0})}})}}),Student=Backbone.Model.extend({idAttribute:"_id",defaults:{image:"http://www.crowdfundinsider.com/shared/avatars/blank_avatar.png"}}),StudentCollection=Backbone.Collection.extend({model:Student,url:"http://0.0.0.0:3000/collections/students"}),AppRouter=Backbone.Router.extend({tableTemplate:_.template($("#table-template").text()),fullTemplate:_.template($("#full-template").text()),editTemplate:_.template($("#edit-template").text()),addTemplate:_.template($("#add-template").text()),initialize:function(){this.students=new StudentCollection},routes:{"":"showStudents",add:"addStudent",":id/edit":"editStudent",":id":"showStudent"},showStudents:function(){function a(a){a.each(function(a){new StudentTableView({model:a})})}$(".container").html(""),$(".container").append(this.tableTemplate()),this.fetchCollection(a)},showStudent:function(a){function b(b){var d=b.get(a);$(".container").html(""),$(".container").append(c.fullTemplate({student:d})),new StudentFullView({model:d})}var c=this;this.fetchCollection(b)},addStudent:function(){function a(a){$(".container").html(""),$(".container").append(b.addTemplate()),a.listenToOnce(a,"add",function(a){new AddStudentView({model:a})}),a.add({})}var b=this;this.fetchCollection(a)},editStudent:function(a){function b(b){$(".container").html("");var d=b.get(a);$(".container").append(c.editTemplate({student:d})),new EditStudentView({model:d})}var c=this;this.fetchCollection(b)},fetchCollection:function(a){0===this.students.length?this.students.fetch({success:function(b){a(b)}}):a(this.students)}}),$(".container").append(_.template($("#table-template").text()));var router=new AppRouter;Backbone.history.start();